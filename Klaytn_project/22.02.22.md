# 1. ì˜¤ëŠ˜ í–ˆë˜ ì¼ê³¼ ì—ëŸ¬ë“¤

- contract.method.balanceOfí•¨ìˆ˜ ì‚¬ìš©ë²•ì„ ìµí˜”ë‹¤.(web3ì™€ ìœ ì‚¬í•´ì„œ web3ì‚¬ìš©ë²•ì„ êµ¬ê¸€ë§í•˜ì—¬ ì‘ìš©í–ˆë‹¤.)
- í† í° ì£¼ì†Œë“¤ì„ ë°°ì—´ì— ë‹´ê³  mapí•¨ìˆ˜ë¡œ arrowí•¨ìˆ˜ì™€ async awaitë¥¼ ì¨ì„œ promiseì˜ resultê°’ ì¶”ì¶œ (í† í°ë“¤ì˜ amountì¡°íšŒ)

<hr />

## balanceOfí•¨ìˆ˜ë¥¼ ë¶ˆëŸ¬ì™€ì„œ í† í°ë“¤ì˜ amountì¡°íšŒ ì„±ê³µ(But, ì—ëŸ¬ê°€ ìˆëŠ” ìƒíƒœ)

```
const contract = new caver.klay.Contract(ABI, "BORAì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ");

const getTokenBalance = function (address) {
    contract.methods
    .balanceOf(address)
    .call({ from: address })
    .then(function (result) {

        if (result) {
            console.log(result);
        }
    });
};
```

ì´ëŸ°ì‹ìœ¼ë¡œ ì»¨íŠ¸ë™ì˜ í•¨ìˆ˜ë¥¼ ë¶ˆëŸ¬ì™€ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br />

- í† í°ìˆ˜ëŸ‰ì¡°íšŒí•˜ëŠ” ë²•ì„ ì•Œì•„ë‚´ê³  í•˜ë‚˜ì˜ í† í°ì—ì„œ ë” ë‚˜ì•„ê°€ ë‹¤ë¥¸ í† í°ë“¤ì˜ ì£¼ì†Œë¥¼ arrayì— ë¬¶ì–´ë†“ê³  mapí•¨ìˆ˜ë¡œ ì‹¤í–‰. ì½œë°±í•¨ìˆ˜ë¥¼ ì£¼ê³  ê±°ê¸°ì— í•¨ìˆ˜ë¥¼ ë„£ì–´ì¤˜ì„œ ê²°ê³¼ê°’ì„ ë¦¬í„´!<br />

[êµ¬ê¸€ë§ ê²°ê³¼](https://richwind.co.kr/89)<br />

- â­ï¸Mapì€ ê° Arrayì˜ ì•„ì´í…œ ë³„ë¡œ functionì„ ì‹¤í–‰ í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ì§€ë§Œ<br />
- â­ï¸forEachëŠ” ì•„ì´í…œë³„ë¡œ ê¸°ëŠ¥ë§Œ ì‹¤í–‰í•˜ê³  ê²°ê³¼ê°’ì´ ë°˜í™˜í•˜ì§€ ì•ŠëŠ”ë‹¤.<br />

```
const addressMap = CONTRACT_ADDRESS.map((ele) => {
  return console.log(ele);
});
```

ì´ë ‡ê²Œ í•œ ê²°ê³¼ í•˜ë‚˜í•˜ë‚˜ì”© ê°’ì„ ì½˜ì†”ì— ë°˜í™˜í•˜ëŠ”ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br />
í•˜ì§€ë§Œ, ì´ë ‡ê²Œí•˜ë©´ ê·¸ëƒ¥ ê·¸ëŒ€ë¡œì˜ ë¬¸ìì—´ë§Œ ë°˜í™˜í•˜ê¸°ì— í•¨ìˆ˜ë¥¼ ë„£ì–´ì¤˜ì„œ ê²°ê³¼ê°’ì„ ê°€ì ¸ì™€ì•¼í•¨<br />

```
  const getTokenBalance = function (address) {
    const ADDRESS_MAP = CONTRACT_ADDRESS.map((ele) => {
      const contract = new caver.klay.Contract(ABI, ele);
      console.log(contract);
      contract.methods
        .balanceOf(address)
        .call({ from: address })
        .then((res) => res);
    });
  };
```

ì´ë ‡ê²Œ ì§„í–‰ì„ í–ˆë”ë‹ˆ, ì˜ ëœ¨ëŠ” ê²½ìš°ë„ìˆì§€ë§Œ ì•„ë˜ì™€ê°™ì´ ì—ëŸ¬ê°€ ë‚¬ë‹¤.<br />
ê·¸ë¦¬ê³ , `Promise {<pending>}`ì´ ëœ¨ëŠ” ê²°ê³¼ë„ ìˆì—ˆë‹¤.<br />
<br />
`POST https://public-node-api.klaytnapi.com/v1/cypress 500 (Service Unavailable)`<br />
`POST https://public-node-api.klaytnapi.com/v1/cypress 503 (Service Unavailable)`<br />
`Uncaught (in promise) Error: Invalid JSON RPC response: "no healthy upstream"`<br />

## mapí•¨ìˆ˜ì— async, awaitë¥¼ ì¨ì„œ ê²°ê³¼ê°’ì„ ë„ì¶œí–ˆë‹¤.<br />

[ë¸”ë¡œê·¸](https://dkmqflx.github.io/frontend/2021/04/24/javascript-map-async-await/)ì°¸ê³ í•˜ì˜€ë‹¤.<br />
[Promise.all()](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Promise/all)<br />

```
Promise.all(
    CONTRACT_ADDRESS.map(async (ele) => {
        const contract = new caver.klay.Contract(ABI, ele);

        await contract.methods
            .balanceOf(address)
            .call({ from: address })
            .then((res) => res);
        });
);
```

ì´ë ‡ê²Œ í•˜ë©´ ë‚´ê°€ ì›í•˜ëŠ” ê°’ì„ ê°€ì ¸ì˜¬ìˆ˜ ìˆì§€ë§Œ 400ì—ëŸ¬ê°€ ë‚œë‹¤..<br />
`POST https://public-node-api.klaytnapi.com/v1/cypress 400 (Bad Request)`<br />
`Uncaught (in promise) Error: Invalid JSON RPC response: {"code":1200503,"message":"error from node API; ","requestId":"1f4394eb-4472-9768-8e1b-82b111a5a50f"}`<br />
í˜¹ì‹œë‚˜ KLAYì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ë¬¸ì œê°€ ìˆëŠ”ê±´ê°€ í™•ì¸í•˜ë‹ˆ KLAY APIë¬¸ì œëŠ” ì•„ë‹ˆê³ , í† í°ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ìƒê¸´ ë¬¸ì œë“¤ì´ë‹¤..ğŸ¥²<br />
ì˜¤ëŠ˜ ê¼­ í•´ê²°í•˜ê³  ë‘ ë°œ ë»—ê³  ì ìê³  ì‹¶ì—ˆì§€ë§Œ, ì‹¤íŒ¨..<br />

<hr />

# ë‚´ì¼ í•  ê²ƒ<br />

- ì˜¤ëŠ˜ í•´ê²°í•˜ì§€ ëª»í•œ ì—ëŸ¬ê³ ì¹˜ê¸°
- methods.transfer()í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°
